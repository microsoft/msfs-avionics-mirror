"use strict";(self.webpackChunkdocs_api=self.webpackChunkdocs_api||[]).push([[70780],{3905:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>h});var i=n(67294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,i,a=function(e,t){if(null==e)return{};var n,i,a={},r=Object.keys(e);for(i=0;i<r.length;i++)n=r[i],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(i=0;i<r.length;i++)n=r[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var l=i.createContext({}),c=function(e){var t=i.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},p=function(e){var t=c(e.components);return i.createElement(l.Provider,{value:t},e.children)},u="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return i.createElement(i.Fragment,{},t)}},m=i.forwardRef((function(e,t){var n=e.components,a=e.mdxType,r=e.originalType,l=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),u=c(n),m=a,h=u["".concat(l,".").concat(m)]||u[m]||d[m]||r;return n?i.createElement(h,o(o({ref:t},p),{},{components:n})):i.createElement(h,o({ref:t},p))}));function h(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var r=n.length,o=new Array(r);o[0]=m;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s[u]="string"==typeof e?e:a,o[1]=s;for(var c=2;c<r;c++)o[c]=n[c];return i.createElement.apply(null,o)}return i.createElement.apply(null,n)}m.displayName="MDXCreateElement"},87553:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>o,default:()=>d,frontMatter:()=>r,metadata:()=>s,toc:()=>c});var i=n(87462),a=(n(67294),n(3905));const r={sidebar_label:"Plugins",sidebar_position:5},o="G3X Touch Plugins",s={unversionedId:"g3xtouch/plugins",id:"g3xtouch/plugins",title:"G3X Touch Plugins",description:"Introduction",source:"@site/docs/g3xtouch/plugins.md",sourceDirName:"g3xtouch",slug:"/g3xtouch/plugins",permalink:"/msfs-avionics-mirror/docs/g3xtouch/plugins",draft:!1,tags:[],version:"current",sidebarPosition:5,frontMatter:{sidebar_label:"Plugins",sidebar_position:5},sidebar:"sidebar",previous:{title:"panel.xml Tag Documentation",permalink:"/msfs-avionics-mirror/docs/g3xtouch/panel-xml-tag-documentation"},next:{title:"UI Framework",permalink:"/msfs-avionics-mirror/docs/g3xtouch/ui-framework"}},l={},c=[{value:"Introduction",id:"introduction",level:2},{value:"Loading Plugin Scripts",id:"loading-plugin-scripts",level:2},{value:"Plugin Interface",id:"plugin-interface",level:2},{value:"Plugin Functionality",id:"plugin-functionality",level:2},{value:"<code>registerUiViews()</code>",id:"registeruiviews",level:3},{value:"<code>registerMfdMainPages()</code>",id:"registermfdmainpages",level:3},{value:"<code>registerPfdInsets()</code>",id:"registerpfdinsets",level:3},{value:"<code>renderEis()</code>",id:"rendereis",level:3},{value:"<code>renderToPfdInstruments()</code>",id:"rendertopfdinstruments",level:3},{value:"<code>getPersistentGlobalSettings()</code>/<code>getPersistentLocalSettings()</code>",id:"getpersistentglobalsettingsgetpersistentlocalsettings",level:3}],p={toc:c},u="wrapper";function d(e){let{components:t,...n}=e;return(0,a.kt)(u,(0,i.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"g3x-touch-plugins"},"G3X Touch Plugins"),(0,a.kt)("h2",{id:"introduction"},"Introduction"),(0,a.kt)("p",null,"The G3X Touch package uses the ",(0,a.kt)("a",{parentName:"p",href:"/msfs-avionics-mirror/docs/plugins/overview"},"Plugin API")," to allow developers to inject their own custom Typescript code into the avionics system in order to implement aircraft-specific features."),(0,a.kt)("h2",{id:"loading-plugin-scripts"},"Loading Plugin Scripts"),(0,a.kt)("p",null,"Global plugin scripts are loaded via XML files in the ",(0,a.kt)("inlineCode",{parentName:"p"},"html_ui/Plugins")," directory. The declared target of the plugin must be equal to ",(0,a.kt)("inlineCode",{parentName:"p"},"G3XTouch")," in order to be loaded by the G3X Touch."),(0,a.kt)("p",null,"Airplane plugin scripts are loaded on a per-instrument basis via ",(0,a.kt)("inlineCode",{parentName:"p"},"panel.xml"),":"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-xml"},"<PlaneHTMLConfig>\n\n  <Instrument>\n    <Name>G3XTouch_1</Name>\n\n    <Plugin>coui://SimObjects/Airplanes/MyAirplane/panel/Instruments/G3XTouch/Plugins/Plugin.js</Plugin>\n  </Instrument>\n\n  <Instrument>\n    <Name>G3XTouch_2</Name>\n\n    <Plugin>coui://SimObjects/Airplanes/MyAirplane/panel/Instruments/G3XTouch/Plugins/Plugin.js</Plugin>\n  </Instrument>\n\n</PlaneHTMLConfig>\n")),(0,a.kt)("admonition",{type:"tip"},(0,a.kt)("p",{parentName:"admonition"},"It is best practice to store aircraft-specific G3X Touch plugin script files (",(0,a.kt)("inlineCode",{parentName:"p"},".js"),") in the aircraft's ",(0,a.kt)("inlineCode",{parentName:"p"},"panel/Instruments/G3XTouch/Plugins/")," subdirectory. This greatly reduces the risk of file conflicts within the sim's virtual file system, because the plugin files are contained in an aircraft-specific subdirectory.")),(0,a.kt)("p",null,"For more detailed information on how plugins are defined and loaded, please refer to the ",(0,a.kt)("a",{parentName:"p",href:"/msfs-avionics-mirror/docs/plugins/overview"},"Plugin API documentation"),"."),(0,a.kt)("h2",{id:"plugin-interface"},"Plugin Interface"),(0,a.kt)("p",null,"G3X Touch plugins conform to the ",(0,a.kt)("a",{parentName:"p",href:"https://microsoft.github.io/msfs-avionics-mirror/docs/g3xtouchcommon/interfaces/G3XTouchPlugin"},(0,a.kt)("inlineCode",{parentName:"a"},"G3XTouchPlugin"))," interface. In addition to all functionality supported by ",(0,a.kt)("a",{parentName:"p",href:"https://microsoft.github.io/msfs-avionics-mirror/docs/plugins/creating-plugins"},"standard plugins"),", G3X Touch plugins support the ",(0,a.kt)("inlineCode",{parentName:"p"},"onInit()")," lifecycle callback method. This callback is called after ",(0,a.kt)("inlineCode",{parentName:"p"},"onInstalled()")," has been called for ",(0,a.kt)("em",{parentName:"p"},"all")," plugins on the same instrument. It is also guaranteed to be called at the beginning of the instrument's initialization process. It is recommended that any plugin initialization tasks that require interaction with core parts of the G3X Touch avionics and/or other plugins be performed in ",(0,a.kt)("inlineCode",{parentName:"p"},"onInit()"),"."),(0,a.kt)("p",null,"G3X Touch plugins are passed the following references via ",(0,a.kt)("inlineCode",{parentName:"p"},"binder"),":"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"The local ",(0,a.kt)("a",{parentName:"li",href:"/msfs-avionics-mirror/docs/getting-started/using-the-event-bus"},"event bus"),"."),(0,a.kt)("li",{parentName:"ul"},"The ",(0,a.kt)("a",{parentName:"li",href:"https://microsoft.github.io/msfs-avionics-mirror/docs/framework/classes/InstrumentBackplane"},"instrument backplane"),"."),(0,a.kt)("li",{parentName:"ul"},"The avionics configuration object (contains global options parsed from ",(0,a.kt)("inlineCode",{parentName:"li"},"panel.xml"),")."),(0,a.kt)("li",{parentName:"ul"},"The instrument configuration object (contains instrument-specific options parsed from ",(0,a.kt)("inlineCode",{parentName:"li"},"panel.xml"),")"),(0,a.kt)("li",{parentName:"ul"},"An instance of ",(0,a.kt)("a",{parentName:"li",href:"https://microsoft.github.io/msfs-avionics-mirror/docs/framework/classes/FacilityLoader"},(0,a.kt)("inlineCode",{parentName:"a"},"FacilityLoader")),"."),(0,a.kt)("li",{parentName:"ul"},"The flight plan lateral path calculator."),(0,a.kt)("li",{parentName:"ul"},"The local flight management system (FMS) ",(0,a.kt)("a",{parentName:"li",href:"https://microsoft.github.io/msfs-avionics-mirror/docs/g3xtouchcommon/classes/G3XFms"},"instance"),"."),(0,a.kt)("li",{parentName:"ul"},"The ",(0,a.kt)("a",{parentName:"li",href:"https://microsoft.github.io/msfs-avionics-mirror/docs/g3xtouchcommon/classes/UiService"},"UI service"),"."),(0,a.kt)("li",{parentName:"ul"},"A collection of all G3X Touch navigation indicators."),(0,a.kt)("li",{parentName:"ul"},"The ",(0,a.kt)("a",{parentName:"li",href:"/msfs-avionics-mirror/docs/cas/cas-system"},"CAS system"),"."),(0,a.kt)("li",{parentName:"ul"},"A ",(0,a.kt)("a",{parentName:"li",href:"https://microsoft.github.io/msfs-avionics-mirror/docs/g3xtouchcommon/interfaces/G3XFplSourceDataProvider"},"provider")," of flight plan source data."),(0,a.kt)("li",{parentName:"ul"},"The local GDU user setting manager."),(0,a.kt)("li",{parentName:"ul"},"The local display user setting manager."),(0,a.kt)("li",{parentName:"ul"},"The local PFD user setting manager.")),(0,a.kt)("h2",{id:"plugin-functionality"},"Plugin Functionality"),(0,a.kt)("p",null,"Each G3X Touch plugin can implement one or more of the following optional methods:"),(0,a.kt)("h3",{id:"registeruiviews"},(0,a.kt)("inlineCode",{parentName:"h3"},"registerUiViews()")),(0,a.kt)("p",null,"This method is used to register additional ",(0,a.kt)("a",{parentName:"p",href:"/msfs-avionics-mirror/docs/g3xtouch/ui-framework"},"views")," with the UI service. This method is guaranteed to be called ",(0,a.kt)("em",{parentName:"p"},"after")," the base G3X Touch has registered all of its views. Therefore, you may replace views registered by the base G3X Touch by registering your own view under the same key."),(0,a.kt)("admonition",{type:"caution"},(0,a.kt)("p",{parentName:"admonition"},"When replacing a base G3X Touch view, ensure that the replacement conforms to the same interface as the view being replaced. Otherwise, you may encounter runtime errors.")),(0,a.kt)("p",null,"In addition to the UI service, a ",(0,a.kt)("a",{parentName:"p",href:"https://microsoft.github.io/msfs-avionics-mirror/docs/g3xtouchcommon/modules#g3xtouchuicomponentcontext"},"context object")," is also passed to this method. The context object contains references to all items not already referenced by the plugin binder that are required to create the base G3X Touch views. These references are provided primarily to make it easy to replace any of these views. However, you are also free to use them when creating brand new views."),(0,a.kt)("h3",{id:"registermfdmainpages"},(0,a.kt)("inlineCode",{parentName:"h3"},"registerMfdMainPages()")),(0,a.kt)("p",null,"This method is used to register additional ",(0,a.kt)("a",{parentName:"p",href:"/msfs-avionics-mirror/docs/g3xtouch/ui-framework#mfd-main-pages"},"MFD main pages"),". This method is guaranteed to be called ",(0,a.kt)("em",{parentName:"p"},"after")," the base G3X Touch has registered all of its pages. Therefore, you may replace pages registered by the base G3X Touch by registering your own page under the same key."),(0,a.kt)("p",null,"In addition to the page registrar, a ",(0,a.kt)("a",{parentName:"p",href:"https://microsoft.github.io/msfs-avionics-mirror/docs/g3xtouchcommon/modules#g3xtouchuicomponentcontext"},"context object")," is also passed to this method. The context object contains references to all items not already referenced by the plugin binder that are required to create the base G3X Touch MFD main pages. These references are provided primarily to make it easy to replace any of these pages. However, you are also free to use them when creating brand new pages."),(0,a.kt)("h3",{id:"registerpfdinsets"},(0,a.kt)("inlineCode",{parentName:"h3"},"registerPfdInsets()")),(0,a.kt)("p",null,"This method is used to register additional PFD insets. This method is guaranteed to be called ",(0,a.kt)("em",{parentName:"p"},"after")," the base G3X Touch has registered all of its insets. Therefore, you may replace insets registered by the base G3X Touch by registering your own inset under the same key."),(0,a.kt)("p",null,"In addition to the inset registrar, a ",(0,a.kt)("a",{parentName:"p",href:"https://microsoft.github.io/msfs-avionics-mirror/docs/g3xtouchcommon/modules#g3xtouchuicomponentcontext"},"context object")," is also passed to this method. The context object contains references to all items not already referenced by the plugin binder that are required to create the base G3X Touch PFD insets. These references are provided primarily to make it easy to replace any of these insets. However, you are also free to use them when creating brand new insets."),(0,a.kt)("h3",{id:"rendereis"},(0,a.kt)("inlineCode",{parentName:"h3"},"renderEis()")),(0,a.kt)("p",null,"This method is used to render custom EIS content. An EIS rendered in this way will replace ",(0,a.kt)("strong",{parentName:"p"},"all")," EIS components configured in ",(0,a.kt)("inlineCode",{parentName:"p"},"panel.xml"),"."),(0,a.kt)("admonition",{type:"note"},(0,a.kt)("p",{parentName:"admonition"},"Support for displaying an EIS must still be declared in ",(0,a.kt)("inlineCode",{parentName:"p"},"panel.xml")," via the ",(0,a.kt)("a",{parentName:"p",href:"/msfs-avionics-mirror/docs/g3xtouch/panel-xml-tag-documentation#eis"},(0,a.kt)("inlineCode",{parentName:"a"},"<Eis>"))," tag before EIS content can be rendered by plugin. If the ",(0,a.kt)("inlineCode",{parentName:"p"},"<Eis>")," tag is not properly defined in ",(0,a.kt)("inlineCode",{parentName:"p"},"panel.xml"),", then no EIS will be displayed in the G3X Touch, even if one or more plugins return a non-null value from ",(0,a.kt)("inlineCode",{parentName:"p"},"renderEis()"),".")),(0,a.kt)("p",null,"If multiple plugins render their own custom EIS contents with this method, then only the one from the plugin that was loaded last is used."),(0,a.kt)("h3",{id:"rendertopfdinstruments"},(0,a.kt)("inlineCode",{parentName:"h3"},"renderToPfdInstruments()")),(0,a.kt)("p",null,"This method is used to render additional components onto the PFD display. Components rendered in this way will be rendered into the DOM after all base G3X Touch components. Therefore, these additional components will by default appear on top of any overlapping base G3X Touch components."),(0,a.kt)("admonition",{type:"caution"},(0,a.kt)("p",{parentName:"admonition"},"When positioning components within the PFD display, remember that the display changes size when switching between Fullscreen and Splitscreen modes, and when the EIS is toggled on/off (if the installation supports displaying an EIS). Additionally, certain base G3X Touch components in the display may change their size, visibility, and/or positioning when the above changes occur.")),(0,a.kt)("h3",{id:"getpersistentglobalsettingsgetpersistentlocalsettings"},(0,a.kt)("inlineCode",{parentName:"h3"},"getPersistentGlobalSettings()"),"/",(0,a.kt)("inlineCode",{parentName:"h3"},"getPersistentLocalSettings()")),(0,a.kt)("p",null,"These methods are used to define user settings whose values should be saved across flights. Settings marked as persistent in this manner will be saved via the MSFS ",(0,a.kt)("inlineCode",{parentName:"p"},"DataStore")," API to the user's cloud save file. Saved settings are loaded during instrument initialization when loading a new flight. Persistent settings are saved on a per-aircraft basis (determined by the airplane's ATC_MODEL)."),(0,a.kt)("p",null,"Global settings are those whose un-aliased names are unique across all G3X Touch instruments. These are typically settings that are synced across different JS/HTML instruments. Local settings are those whose un-aliased names are unique within each G3X Touch instrument, but may not be unique when compared across different instruments. These are typically settings that are not synced across instruments (e.g. those managed by a ",(0,a.kt)("inlineCode",{parentName:"p"},"DefaultUserSettingManager")," instantiated with the ",(0,a.kt)("a",{parentName:"p",href:"https://microsoft.github.io/msfs-avionics-mirror/docs/framework/classes/DefaultUserSettingManager#constructor"},(0,a.kt)("inlineCode",{parentName:"a"},"keepLocal"))," option)."),(0,a.kt)("admonition",{type:"tip"},(0,a.kt)("p",{parentName:"admonition"},"A new cloud save data key is generated and written for each persistent user setting ",(0,a.kt)("em",{parentName:"p"},"per aircraft")," as soon as the instrument initializes after loading a flight. Currently there is no mechanism by which you can remove data keys from cloud save files. This means that once a key is added to a cloud save, it can never be removed."),(0,a.kt)("p",{parentName:"admonition"},'As such, it is highly recommended that you finalize the names of all would-be persistent user settings before allowing them to be saved. This will help to minimize the number of "junk" keys written to the cloud saves of anybody running your plugin code.')))}d.isMDXComponent=!0}}]);